<!DOCTYPE html>
<html>
<head>
  <title>支出記録アプリ</title>
  <style>
    table {
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid black;
      padding: 8px;
    }
    form {
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h1>支出記録</h1>

  <form id="expense-form">
    <label for="expense-name">支出名:</label>
    <input type="text" id="expense-name" required>
    <label for="expense-amount">金額:</label>
    <input type="number" id="expense-amount" required>
    <button type="submit">追加</button>
  </form>

  <table id="expense-table">
    <thead>
      <tr>
        <th>支出名</th>
        <th>金額</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
    <tfoot>
      <tr>
        <th>合計</th>
        <th id="total-amount">0</th>
        <th></th>
      </tr>
    </tfoot>
  </table>

  <script>
    // ページが読み込まれたときにローカルストレージからデータを復元
    window.addEventListener('load', function() {
      const expenses = JSON.parse(localStorage.getItem('expenses')) || [];
      renderExpenses(expenses);
      updateTotalAmount(expenses);
    });

    // 支出フォームの送信イベント
    document.getElementById('expense-form').addEventListener('submit', function(event) {
      event.preventDefault();
      
      const expenseName = document.getElementById('expense-name').value;
      const expenseAmount = parseFloat(document.getElementById('expense-amount').value);

      if (!expenseName || isNaN(expenseAmount)) {
        alert('支出名と金額を入力してください。');
        return;
      }

      const expense = { name: expenseName, amount: expenseAmount };
      const expenses = JSON.parse(localStorage.getItem('expenses')) || [];
      expenses.push(expense);
      localStorage.setItem('expenses', JSON.stringify(expenses));

      renderExpenses(expenses);
      updateTotalAmount(expenses);

      document.getElementById('expense-name').value = '';
      document.getElementById('expense-amount').value = '';
    });

    // 支出を表示する関数
    function renderExpenses(expenses) {
      const tableBody = document.getElementById('expense-table').getElementsByTagName('tbody')[0];
      tableBody.innerHTML = '';

      for (let i = 0; i < expenses.length; i++) {
        const expense = expenses[i];
        const row = tableBody.insertRow(i);
        const nameCell = row.insertCell(0);
        const amountCell = row.insertCell(1);
        const deleteCell = row.insertCell(2);

        nameCell.textContent = expense.name;
        amountCell.textContent = expense.amount;
        deleteCell.innerHTML = '<button onclick="deleteExpense(' + i + ')">削除</button>';
      }
    }

    // 合計金額を更新する関数
    function updateTotalAmount(expenses) {
      const totalAmountCell = document.getElementById('total-amount');
            const totalAmountCell = document.getElementById('total-amount');
      let sum = 0;
      for (let i = 0; i < expenses.length; i++) {
        sum += expenses[i].amount;
      }
      totalAmountCell.textContent = sum;
    }

    // 支出を削除する関数
    function deleteExpense(index) {
      const expenses = JSON.parse(localStorage.getItem('expenses')) || [];
      expenses.splice(index, 1);
      localStorage.setItem('expenses', JSON.stringify(expenses));

      renderExpenses(expenses);
      updateTotalAmount(expenses);
    }
  </script>
</body>
</html>

